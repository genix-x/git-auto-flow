#!/bin/bash
# Git Auto-Flow - Installation des alias et configuration

set -e

# Couleurs pour les messages
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

# Variables
INSTALL_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
CURRENT_USER=$(whoami)

echo -e "${BLUE}üöÄ Git Auto-Flow - Installation${NC}"
echo -e "${BLUE}=================================${NC}"
echo -e "üìç R√©pertoire d'installation: ${INSTALL_DIR}"
echo ""

# 1. V√©rification des pr√©requis
echo -e "${BLUE}üîç V√©rification des pr√©requis...${NC}"

# Python 3
if ! command -v python3 &> /dev/null; then
    echo -e "${RED}‚ùå Python3 non trouv√©${NC}"
    echo -e "${YELLOW}üí° Installez Python3 d'abord:${NC}"
    echo -e "   macOS: brew install python3"
    echo -e "   Ubuntu: sudo apt install python3 python3-pip"
    exit 1
fi
echo -e "${GREEN}‚úÖ Python3 trouv√©: $(python3 --version)${NC}"

# pip3
if ! command -v pip3 &> /dev/null; then
    echo -e "${RED}‚ùå pip3 non trouv√©${NC}"
    exit 1
fi
echo -e "${GREEN}‚úÖ pip3 trouv√©${NC}"

# Git
if ! command -v git &> /dev/null; then
    echo -e "${RED}‚ùå Git non trouv√©${NC}"
    exit 1
fi
echo -e "${GREEN}‚úÖ Git trouv√©: $(git --version)${NC}"

# GitHub CLI
if ! command -v gh &> /dev/null; then
    echo -e "${YELLOW}‚ö†Ô∏è  GitHub CLI (gh) non trouv√©${NC}"
    echo -e "${YELLOW}üí° Installation recommand√©e:${NC}"
    echo -e "   macOS: brew install gh"
    echo -e "   Ubuntu: sudo apt install gh"
    echo -e "   Ou: https://github.com/cli/cli/releases"
    echo ""
    read -p "Continuer sans GitHub CLI? (y/N): " -n 1 -r
    echo
    if [[ ! $REPLY =~ ^[Yy]$ ]]; then
        exit 1
    fi
else
    echo -e "${GREEN}‚úÖ GitHub CLI trouv√©: $(gh --version | head -n1)${NC}"
fi

echo ""

# 2. Installation des d√©pendances Python
echo -e "${BLUE}üì¶ Installation des d√©pendances Python...${NC}"

if [ -f "${INSTALL_DIR}/requirements.txt" ]; then
    pip3 install -r "${INSTALL_DIR}/requirements.txt" --break-system-packages 2>/dev/null || pip3 install -r "${INSTALL_DIR}/requirements.txt"
    echo -e "${GREEN}‚úÖ D√©pendances Python install√©es${NC}"
else
    echo -e "${YELLOW}‚ö†Ô∏è  requirements.txt non trouv√©, installation manuelle...${NC}"
    pip3 install google-generativeai python-dotenv groq --break-system-packages 2>/dev/null || pip3 install google-generativeai python-dotenv groq
fi

echo ""

# 3. Installation gitleaks pour s√©curit√©
echo -e "${BLUE}üì¶ Installation gitleaks (s√©curit√©)...${NC}"
if command -v brew &> /dev/null; then
    if ! command -v gitleaks &> /dev/null; then
        brew install gitleaks --quiet 2>/dev/null && echo -e "${GREEN}‚úÖ gitleaks install√© via brew${NC}" || echo -e "${YELLOW}‚ö†Ô∏è  Installation gitleaks via brew √©chou√©e${NC}"
    else
        echo -e "${GREEN}‚úÖ gitleaks d√©j√† install√©${NC}"
    fi
elif command -v curl &> /dev/null; then
    if [[ ! -f "${INSTALL_DIR}/bin/gitleaks" ]]; then
        echo "üì• T√©l√©chargement gitleaks depuis GitHub..."
        GITLEAKS_VERSION="8.18.4"
        OS=$(uname -s | tr '[:upper:]' '[:lower:]')
        ARCH=$(uname -m)
        if [[ "$ARCH" == "x86_64" ]]; then ARCH="amd64"; fi
        if [[ "$ARCH" == "arm64" ]] && [[ "$OS" == "darwin" ]]; then ARCH="arm64"; fi
        
        curl -L "https://github.com/gitleaks/gitleaks/releases/download/v${GITLEAKS_VERSION}/gitleaks_${GITLEAKS_VERSION}_${OS}_${ARCH}.tar.gz" -o /tmp/gitleaks.tar.gz 2>/dev/null && {
            tar -xzf /tmp/gitleaks.tar.gz -C /tmp/ 2>/dev/null && {
                mkdir -p "${INSTALL_DIR}/bin"
                mv /tmp/gitleaks "${INSTALL_DIR}/bin/"
                chmod +x "${INSTALL_DIR}/bin/gitleaks"
                rm /tmp/gitleaks.tar.gz
                echo -e "${GREEN}‚úÖ gitleaks install√© dans ${INSTALL_DIR}/bin/${NC}"
            } || echo -e "${YELLOW}‚ö†Ô∏è  Extraction gitleaks √©chou√©e${NC}"
        } || echo -e "${YELLOW}‚ö†Ô∏è  T√©l√©chargement gitleaks √©chou√©${NC}"
    else
        echo -e "${GREEN}‚úÖ gitleaks d√©j√† install√© dans ${INSTALL_DIR}/bin/${NC}"
    fi
else
    echo -e "${YELLOW}‚ö†Ô∏è  curl et brew non trouv√©s - gitleaks non install√©${NC}"
fi
echo ""

# 4. Configuration des alias Git
echo -e "${BLUE}‚öôÔ∏è  Configuration des alias Git...${NC}"

# Sauvegarde de la configuration actuelle
if [ -f ~/.gitconfig ]; then
    cp ~/.gitconfig ~/.gitconfig.backup.$(date +%Y%m%d_%H%M%S)
    echo -e "${GREEN}‚úÖ Sauvegarde de ~/.gitconfig cr√©√©e${NC}"
fi

# V√©rifier et supprimer les anciens alias Git Auto-Flow s'ils existent
if grep -q "# Git Auto-Flow" ~/.gitconfig 2>/dev/null; then
    echo -e "${YELLOW}‚ö†Ô∏è  Suppression des anciens alias Git Auto-Flow...${NC}"
    # Cr√©er une copie temporaire sans les alias Git Auto-Flow
    grep -v "# Git Auto-Flow" ~/.gitconfig > ~/.gitconfig.tmp 2>/dev/null || touch ~/.gitconfig.tmp
    # Supprimer aussi les lignes entre "# Git Auto-Flow" et la prochaine section
    sed '/# Git Auto-Flow/,/^$/d' ~/.gitconfig > ~/.gitconfig.tmp 2>/dev/null || touch ~/.gitconfig.tmp
    mv ~/.gitconfig.tmp ~/.gitconfig
    echo -e "${GREEN}‚úÖ Anciens alias supprim√©s${NC}"
fi

# Configuration s√©curis√©e des alias via git config
echo -e "${BLUE}üîß Configuration des alias Git Auto-Flow...${NC}"

# üöÄ WORKFLOW PRINCIPAL avec IA
git config --global alias.feature-start "!f() { 
    echo 'üöÄ Feature: '\$1; 
    echo 'üßπ Nettoyage des branches merg√©es...'; 
    git fetch --prune origin 2>/dev/null || true; 
    git branch --merged main 2>/dev/null | grep 'feature/' | xargs -n 1 git branch -d 2>/dev/null || true; 
    git branch --merged develop 2>/dev/null | grep 'feature/' | xargs -n 1 git branch -d 2>/dev/null || true; 
    git branch -r --merged main 2>/dev/null | grep 'origin/feature/' | sed 's/origin\\///' | xargs -n 1 git push origin --delete 2>/dev/null || true; 
    git branch -r --merged develop 2>/dev/null | grep 'origin/feature/' | sed 's/origin\\///' | xargs -n 1 git push origin --delete 2>/dev/null || true; 
    git checkout develop 2>/dev/null || git checkout -b develop; 
    git pull origin develop 2>/dev/null || true; 
    git checkout -b feature/\$1 && 
    git push -u origin feature/\$1 2>/dev/null || true; 
    echo '‚úÖ Feature cr√©√©e: feature/'\$1; 
}; f"

# Commit avec rebase + IA
git config --global alias.commit-auto "!cd \$(git rev-parse --show-toplevel) && python3 ${INSTALL_DIR}/src/git-commit-auto.py"

# Alias courts
git config --global alias.ca "!git commit-auto"
git config --global alias.pr "!cd \$(git rev-parse --show-toplevel) && python3 ${INSTALL_DIR}/src/git-pr-auto.py"

# Finaliser feature (avant PR)
git config --global alias.feature-finish "!f() { echo 'üîÑ Finalisation de la feature...'; git fetch origin develop && git rebase origin/develop && git push --force-with-lease origin \$(git branch --show-current) && echo '‚úÖ Feature pr√™te pour PR vers develop'; }; f"

# PR automation
git config --global alias.pr-create-auto "!cd \$(git rev-parse --show-toplevel) && python3 ${INSTALL_DIR}/src/git-pr-create-auto.py"

# Deploy automation
git config --global alias.deploy "!cd \$(git rev-parse --show-toplevel) && python3 ${INSTALL_DIR}/src/git-release-auto.py"

# Nettoyage des branches
git config --global alias.cleanup-branches "!f() { echo 'üßπ Nettoyage des branches locales...'; git fetch --prune origin; git branch --merged develop | grep -v 'develop\\|main\\|master' | xargs -n 1 git branch -d 2>/dev/null || true; git branch --merged main | grep -v 'develop\\|main\\|master' | xargs -n 1 git branch -d 2>/dev/null || true; echo '‚úÖ Branches merg√©es supprim√©es'; }; f"


echo "üìã Configuration des alias pour la gestion de projets..."

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# üéØ GESTION DE PROJETS GITHUB  
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

# Configuration projets
git config --global alias.project-config "!cd \$(git rev-parse --show-toplevel 2>/dev/null || pwd) && python3 ${INSTALL_DIR}/src/git-project-config.py"
git config --global alias.pc "!git project-config"  # Alias court


echo -e "${GREEN}‚úÖ Alias Git Auto-Flow configur√©s proprement${NC}"

# 4. Configuration du repository Git Flow
echo ""
echo -e "${BLUE}üåø Configuration Git Flow (develop/main)...${NC}"

# V√©rifier qu'on est dans un repo Git
if ! git rev-parse --is-inside-work-tree >/dev/null 2>&1; then
    echo -e "${RED}‚ùå Pas dans un repository Git${NC}"
    echo -e "${YELLOW}üí° Lancez cette commande depuis un repo Git${NC}"
    exit 1
fi

# Cr√©er branche develop si elle n'existe pas
if ! git show-ref --verify --quiet refs/heads/develop; then
    echo -e "${YELLOW}üìù Cr√©ation de la branche develop...${NC}"
    
    # S'assurer qu'on est sur main
    if git show-ref --verify --quiet refs/heads/main; then
        git checkout main >/dev/null 2>&1 || true
        git pull origin main >/dev/null 2>&1 || echo -e "${YELLOW}‚ö†Ô∏è  Pull main ignor√© (pas de remote ou conflit)${NC}"
    fi
    
    # Cr√©er develop depuis main (ou HEAD si main n'existe pas)
    git checkout -b develop >/dev/null 2>&1
    echo -e "${GREEN}‚úÖ Branche develop cr√©√©e localement${NC}"
    
    # Push develop vers origin si possible
    if git remote get-url origin >/dev/null 2>&1; then
        if git push -u origin develop >/dev/null 2>&1; then
            echo -e "${GREEN}‚úÖ Branche develop push√©e vers origin${NC}"
        else
            echo -e "${YELLOW}‚ö†Ô∏è  Push develop √©chou√© (configurez origin d'abord)${NC}"
        fi
    else
        echo -e "${YELLOW}‚ö†Ô∏è  Pas de remote origin configur√©${NC}"
    fi
else
    echo -e "${GREEN}‚úÖ Branche develop existe d√©j√†${NC}"
fi

# Configurer branch protection via GitHub CLI si disponible
if command -v gh &> /dev/null; then
    echo -e "${BLUE}üõ°Ô∏è  Configuration protection develop...${NC}"
    
    # V√©rifier qu'on est connect√© √† GitHub
    if gh auth status >/dev/null 2>&1; then
        # Protection develop (require PR + up-to-date)
        gh api repos/:owner/:repo/branches/develop/protection \
          --method PUT \
          --field required_status_checks='{"strict":true,"contexts":[]}' \
          --field enforce_admins=true \
          --field required_pull_request_reviews='{"required_approving_review_count":1,"dismiss_stale_reviews":true}' \
          --field restrictions=null \
          >/dev/null 2>&1 && echo -e "${GREEN}‚úÖ Protection develop activ√©e${NC}" || echo -e "${YELLOW}‚ö†Ô∏è  Protection develop √©chou√©e (permissions?)${NC}"
        
        # Protection main (require PR + up-to-date)  
        if git show-ref --verify --quiet refs/heads/main; then
            gh api repos/:owner/:repo/branches/main/protection \
              --method PUT \
              --field required_status_checks='{"strict":true,"contexts":[]}' \
              --field enforce_admins=true \
              --field required_pull_request_reviews='{"required_approving_review_count":1,"dismiss_stale_reviews":true}' \
              --field restrictions=null \
              >/dev/null 2>&1 && echo -e "${GREEN}‚úÖ Protection main activ√©e${NC}" || echo -e "${YELLOW}‚ö†Ô∏è  Protection main √©chou√©e${NC}"
        fi
        
        # Configuration auto-suppression des branches apr√®s merge
        gh api repos/:owner/:repo \
          --method PATCH \
          --field delete_branch_on_merge=true \
          >/dev/null 2>&1 && echo -e "${GREEN}‚úÖ Auto-suppression branches activ√©e${NC}" || echo -e "${YELLOW}‚ö†Ô∏è  Auto-suppression √©chou√©e${NC}"
        
        # Cr√©ation du label 'release' pour les PRs de release
        echo -e "${YELLOW}üè∑Ô∏è  Cr√©ation du label 'release'...${NC}"
        gh label create release --color "0052CC" --description "Release PR develop->main" \
          >/dev/null 2>&1 && echo -e "${GREEN}‚úÖ Label 'release' cr√©√©${NC}" || echo -e "${YELLOW}‚ö†Ô∏è  Label 'release' existe d√©j√† ou erreur${NC}"
    else
        echo -e "${YELLOW}‚ö†Ô∏è  GitHub CLI non connect√© - lancez: gh auth login${NC}"
        echo -e "${YELLOW}üí° Protection manuelle requise sur GitHub.com${NC}"
    fi
else
    echo -e "${YELLOW}‚ö†Ô∏è  GitHub CLI non trouv√© - protection manuelle requise${NC}"
fi

# Revenir sur develop pour setup
git checkout develop >/dev/null 2>&1 || true

# Cr√©er tag initial v0.0.0 pour semantic-release (si pas d√©j√† cr√©√©)
if ! git tag -l | grep -q "^v0\.0\.0$"; then
    echo -e "${YELLOW}üè∑Ô∏è  Cr√©ation du tag initial v0.0.0 pour versioning...${NC}"
    if git tag v0.0.0 >/dev/null 2>&1; then
        echo -e "${GREEN}‚úÖ Tag v0.0.0 cr√©√© localement${NC}"
        
        # Push le tag vers origin si possible
        if git remote get-url origin >/dev/null 2>&1; then
            if git push origin v0.0.0 >/dev/null 2>&1; then
                echo -e "${GREEN}‚úÖ Tag v0.0.0 push√© vers origin${NC}"
                echo -e "${YELLOW}üí° Semantic-release d√©marrera √† v0.1.0${NC}"
            else
                echo -e "${YELLOW}‚ö†Ô∏è  Push tag √©chou√© - pushez manuellement: git push origin v0.0.0${NC}"
            fi
        else
            echo -e "${YELLOW}‚ö†Ô∏è  Tag cr√©√© localement uniquement${NC}"
        fi
    else
        echo -e "${YELLOW}‚ö†Ô∏è  Cr√©ation du tag √©chou√©e${NC}"
    fi
else
    echo -e "${GREEN}‚úÖ Tag v0.0.0 existe d√©j√†${NC}"
fi

# 5. Installation semantic-release (si Node.js disponible)
if command -v npm &> /dev/null || command -v pnpm &> /dev/null || command -v yarn &> /dev/null; then
    echo ""
    echo -e "${BLUE}üì¶ Installation semantic-release...${NC}"
    
    # Utiliser pnpm si disponible, sinon npm
    if command -v pnpm &> /dev/null; then
        PACKAGE_MANAGER="pnpm"
    elif command -v yarn &> /dev/null; then
        PACKAGE_MANAGER="yarn"
    else
        PACKAGE_MANAGER="npm"
    fi
    
    echo -e "${YELLOW}üì¶ Utilisation de ${PACKAGE_MANAGER}...${NC}"
    
    # Installation des d√©pendances semantic-release
    if $PACKAGE_MANAGER install >/dev/null 2>&1; then
        echo -e "${GREEN}‚úÖ Semantic-release install√©${NC}"
        echo -e "${YELLOW}üí° Releases automatiques activ√©es sur push vers main${NC}"
    else
        echo -e "${YELLOW}‚ö†Ô∏è  Installation semantic-release √©chou√©e${NC}"
        echo -e "${YELLOW}üí° Les releases devront √™tre cr√©√©es manuellement${NC}"
    fi
else
    echo -e "${YELLOW}‚ö†Ô∏è  Node.js non trouv√© - semantic-release d√©sactiv√©${NC}"
    echo -e "${YELLOW}üí° Installez Node.js pour les releases automatiques${NC}"
fi

# 6. Configuration interactive des cl√©s API  
echo ""
echo -e "${BLUE}üîë Configuration des cl√©s API...${NC}"

# V√©rifier si le fichier global existe d√©j√†
GLOBAL_ENV_FILE="$HOME/.env.gitautoflow"
if [ -f "$GLOBAL_ENV_FILE" ]; then
    echo -e "${GREEN}‚úÖ Configuration API trouv√©e: $GLOBAL_ENV_FILE${NC}"
    echo -e "${YELLOW}üí° Cl√©s API d√©j√† configur√©es - installation continue...${NC}"
    echo ""
else
    # Configuration interactive seulement si le fichier n'existe pas
    echo -e "${YELLOW}üí° Configurons vos cl√©s API (optionnel):${NC}"
    echo ""

    # Gemini API
    echo -e "${BLUE}ü§ñ Gemini API (Google AI Studio):${NC}"
    echo -e "   üîó ${YELLOW}https://makersuite.google.com/app/apikey${NC}"
    read -p "Entrez votre cl√© Gemini API (ou ENTER pour ignorer): " GEMINI_KEY

    # Groq API  
    echo ""
    echo -e "${BLUE}‚ö° Groq API (Fallback gratuit):${NC}"
    echo -e "   üîó ${YELLOW}https://console.groq.com/keys${NC}"
    read -p "Entrez votre cl√© Groq API (ou ENTER pour ignorer): " GROQ_KEY

    # √âcriture dans le fichier global
    {
        echo "# Git Auto-Flow - Configuration des API"
        echo "# G√©n√©r√© automatiquement le $(date)"
        echo ""
        echo "GEMINI_API_KEY=${GEMINI_KEY}"
        echo "GROQ_API_KEY=${GROQ_KEY}"
    } > "$GLOBAL_ENV_FILE"

    echo -e "${GREEN}‚úÖ Cl√©s API configur√©es dans $GLOBAL_ENV_FILE${NC}"
    echo ""
fi


# V√©rification finale de la configuration
if [ -f "$GLOBAL_ENV_FILE" ]; then
    # V√©rifier si au moins une cl√© est configur√©e dans le fichier
    if grep -q "GEMINI_API_KEY=.\+" "$GLOBAL_ENV_FILE" || grep -q "GROQ_API_KEY=.\+" "$GLOBAL_ENV_FILE"; then
        echo -e "${GREEN}‚úÖ Cl√©s API configur√©es${NC}"
    else
        echo -e "${YELLOW}‚ö†Ô∏è  Fichier .env.gitautoflow existe mais aucune cl√© valide trouv√©e${NC}"
    fi
else
    echo -e "${YELLOW}‚ö†Ô∏è  Aucune cl√© API configur√©e${NC}"
    echo -e "${YELLOW}üí° Les scripts afficheront des messages d'erreur appropri√©s${NC}"
fi

# 7. Test de l'installation
echo ""
echo -e "${BLUE}üß™ Test de l'installation...${NC}"

if git cz-auto --help >/dev/null 2>&1 || python3 "${INSTALL_DIR}/src/git-cz-auto-v2.py" --help >/dev/null 2>&1; then
    echo -e "${GREEN}‚úÖ Installation r√©ussie!${NC}"
else
    echo -e "${YELLOW}‚ö†Ô∏è  Test partiel - configurez les cl√©s API${NC}"
fi

# 8. Instructions finales
echo ""
echo -e "${GREEN}üéâ Installation termin√©e!${NC}"
echo ""
echo -e "${BLUE}üìã Git Flow complet configur√©:${NC}"
echo -e "   ${GREEN}üåø develop${NC} (int√©gration) ‚Üê ${GREEN}üöÄ feature/*${NC}"
echo -e "   ${GREEN}üéØ main${NC} (production) ‚Üê ${GREEN}üåø develop${NC} (release)"
echo ""
echo -e "${BLUE}üöÄ WORKFLOW COMPLET - Git Auto-Flow:${NC}"
echo ""
echo -e "${YELLOW}üìã D√©veloppement d'une feature:${NC}"
echo -e "   1Ô∏è‚É£  ${GREEN}git feature-start ma-feature${NC}  # Cr√©e feature/ma-feature depuis develop"
echo -e "   2Ô∏è‚É£  ${GREEN}git commit-auto${NC} (ou ${GREEN}git ca${NC})    # Commit avec IA + rebase auto"  
echo -e "   3Ô∏è‚É£  ${GREEN}git feature-finish${NC}            # Finalise feature (rebase + push)"
echo -e "   4Ô∏è‚É£  ${GREEN}git pr-create-auto${NC}            # Cr√©e PR avec analyse IA compl√®te"
echo ""
echo -e "${YELLOW}üìã Gestion des releases:${NC}"
echo -e "   5Ô∏è‚É£  Merge PR ‚Üí ${GREEN}develop${NC}         # (branche auto-supprim√©e)"
echo -e "   6Ô∏è‚É£  ${GREEN}git deploy${NC}                  # üöÄ Deploy AUTO: develop‚Üímain + auto-merge"
echo -e "   7Ô∏è‚É£  Auto-merge ‚Üí ${GREEN}main${NC} = üè∑Ô∏è ${YELLOW}v0.1.0 Tag + Release automatique !${NC}"
echo ""
echo -e "${YELLOW}üßπ Maintenance:${NC}"
echo -e "   üîß  ${GREEN}git cleanup-branches${NC}          # Nettoie branches locales merg√©es"
echo ""
echo -e "${YELLOW}ü§ñ APIs support√©es:${NC}"
if [ ! -z "$GEMINI_KEY" ]; then
    echo -e "   ‚úÖ  ${GREEN}Gemini${NC} (Google AI) - Configur√©"
else
    echo -e "   ‚ö†Ô∏è   ${YELLOW}Gemini${NC} (Google AI) - √Ä configurer"
fi
if [ ! -z "$GROQ_KEY" ]; then
    echo -e "   ‚úÖ  ${GREEN}Groq${NC} (Fallback) - Configur√©"  
else
    echo -e "   ‚ö†Ô∏è   ${YELLOW}Groq${NC} (Fallback) - √Ä configurer"
fi
echo ""
echo -e "${YELLOW}üéØ R√©sultat: Workflow Git 100% automatis√© avec IA !${NC}"
echo ""
echo -e "${BLUE}üîß Configuration:${NC}"
echo -e "   1. √âditez: ${YELLOW}$HOME/.env.gitautoflow${NC}"
echo -e "   2. Ajoutez vos cl√©s API (Gemini + Groq)"
echo -e "   3. Testez: ${GREEN}git commit-auto${NC} dans un repo Git"
echo ""
echo -e "${BLUE}üìö Documentation compl√®te:${NC}"
echo -e "   ${YELLOW}${INSTALL_DIR}/README.md${NC}"
echo ""
echo -e "${GREEN}‚ú® Git Auto-Flow est pr√™t √† l'emploi!${NC}"
